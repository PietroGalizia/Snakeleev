<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snakeleev</title>
    <style>
       /* ---- IMPOSTAZIONI GENERALI ---- */
/* Generale */
html, body {
    height: 100%;
    margin: 0;
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #002F5F 30%, #013A74 100%);
    color: white;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

/* Loghi */
#logoCNR-container, #logoCG-container {
    position: absolute;
    top: 20px;
    cursor: pointer;
}

#logoCNR-container { left: 10px; }
#logoCG-container { right: 10px; }

#logoCNR { width: 250px; height: auto; }
#logoCG { width: 90px; height: auto; }

/* Contenitore principale */
#content {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding-top: 20px;
    width: 90%;
    max-width: 800px;
    margin-top: 50px;
}

/* Titoli */
h1 {
    font-size: 3.8rem;
    margin: 15px;
    text-shadow: 2px 2px 12px rgba(0, 0, 0, 0.6);
}

/* Schermata iniziale */
#startScreen {
    background: rgba(255, 255, 255, 0.08);
    padding: 30px;
    border-radius: 14px;
    box-shadow: 0px 6px 15px rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(12px);
    width: 80%;
    max-width: 600px;
}

/* Contenitore per gli slider */
.slider-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 90%;
    max-width: 500px;
    text-align: center;
    margin-bottom: 20px;
    padding: 12px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    box-shadow: 0px 3px 6px rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(150, 174, 33, 0.6);
}

/* Etichette */
.slider-label {
    font-size: 1.4rem;
    font-weight: bold;
    margin-bottom: 5px;
}
        
/* Slider */
.speed-container, input[type="range"] {
    width: 80%;
    max-width: 500px;
    margin-bottom: 20px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(10px);
}

.speed-label {
    font-size: 1.4rem;
    font-weight: bold;
    margin-bottom: 10px;
}

/* Slider */
input[type="range"] {
    width: 85%;
    height: 10px;
    -webkit-appearance: none;
    appearance: none;
    background: linear-gradient(90deg, #96AE21 0%, #417F45 100%);
    border-radius: 5px;
    outline: none;
    transition: 0.3s;
}

input[type="range"]:hover {
    background: linear-gradient(90deg, #A2C627 0%, #3D773D 100%);
}
        
/* Valore della velocità */
#selectedSpeed {
    font-size: 1.2rem;
    font-weight: bold;
    margin-top: 10px;
    color: #96AE21;
}

/* Valori dinamici */
.slider-value {
    font-size: 1.2rem;
    font-weight: bold;
    margin-bottom: 5px;
    color: #96AE21; 
}

/* Pulsanti */
/* Contenitore per i pulsanti Instructions e Play */
.button-container {
    display: flex;
    justify-content: center;
    gap: 20px;  /* Spazio tra i pulsanti */
    margin-top: 15px;
}

/* Pulsanti */
.button {
    padding: 12px 20px;
    background-color: #96AE21;
    border: 2px solid rgba(150, 174, 33, 0.6);
    border-radius: 12px;
    color: white;
    font-size: 1.3rem;
    cursor: pointer;
    transition: background-color 0.3s, transform 0.2s, box-shadow 0.2s;
    width: 150px; /* Assicura che i pulsanti abbiano la stessa dimensione */
    text-align: center;
}

.button:hover {
    background-color: #417F45;
    transform: scale(1.05);
    box-shadow: 0px 5px 10px rgba(65, 127, 69, 0.7);
}
        
/* Menu a tendina */
select {
    width: 85%;
    padding: 12px;
    border-radius: 8px;
    border: none;
    font-size: 1.2rem;
    text-align: center;
    background: white;
    color: #002F5F;
    cursor: pointer;
    transition: 0.3s;
}

select:hover {
    background: #f3f3f3;
}

/* Istruzioni */
#instructions {
    display: none;
    margin-top: 20px;
    padding: 20px;
    border-radius: 12px;
    background: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(10px);
    text-align: left;
}

#instructions h3 {
    text-transform: uppercase;
    font-size: 1.5rem;
    margin-bottom: 10px;
    color: #96AE21;
}

#instructions ol {
    margin-left: 20px;
    font-size: 1.1rem;
}

/* Canvas */
#gameCanvas {
    display: none;
    background-color: #002F5F;
    margin: 0 auto;
    max-width: 100%;
    max-height: 100%;
    border-radius: 8px;
    box-shadow: 0px 5px 10px rgba(0, 0, 0, 0.4);
}

/* Punteggio */
#scoreBoard {
    display: none;
    font-size: 1.7rem;
    font-weight: bold;
    margin-top: 20px;
}

/* Citazione */
#citation {
    margin-top: 20px;
    font-size: 14px;
    text-align: center;
    color: white;
}

#citation a {
    text-decoration: none;
    color: #96AE21;
    transition: color 0.3s;
}

#citation a:hover {
    color: #e51a4b;
}


        #touchArea {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: transparent;
        }

        #gameCanvas {
            display: none;
            background-color: #002F5F;
            margin: 0px auto;
            max-width: 100%;
            max-height: 100%;
        }
        
    </style>
</head>
<body>
    <div id="logoCNR-container" onclick="window.open('https://www.issmc.cnr.it/en/', '_blank')">
        <img id="logoCNR" src="logo.png" alt="Logo CNR-ISSMC">
    </div>

    <div id="logoCG-container" onclick="window.open('https://www.changegame.cnr.it/', '_blank')">
        <img id="logoCG" src="LogoChangeGame.png" alt="Logo ChangeGame">
    </div>
    
    <div id="content">
        <h1 id="title">Snakeleev</h1>

    <!-- Schermata iniziale-->
    <div id="startScreen">

    <h2>Snake's Diet</h2>
    <select id="dietDropdown"></select>
        
    <!-- Contenitore per la selezione della velocità -->
    <div class="slider-container">
        <p id="selectedSpeed" class="slider-value">Speed: 3</p>
        <input id="speedRange" type="range" min="1" max="5" value="3" oninput="updateSpeedLabel()">
    </div>

    <div class="slider-container">
        <p id="selectedElementCount" class="slider-value">Element Range: 1 ≤ Z ≤ 40</p>
            <input id="elementRange" type="range" min="1" max="118" value="40" oninput="updateElementCount()">
            
    </div>
    
    <div class="button-container">
        <button class="button" onclick="toggleInstructions()">Instructions</button>
        <button class="button" onclick="finalSelection()">Play</button>
    </div>


    <!-- Istruzioni inizialmente nascoste -->
    <div id="instructions">
        <h3>INSTRUCTIONS</h3>
        <ol>
            <li>Control the snake using the arrow keys or W, A, S, and D.</li>
            <li id="eat-instruction">Eat only the elements of the selected diet.</li>
            <li>Press the spacebar to swap the two elements.</li>
            <li>Press "P" to pause or resume the game.</li>
            <li>Refresh the page to start a new game.</li>
        </ol>
        <h3>SCORING SYSTEM</h3>
        <p>
            Your score increases when you eat an element that belongs to the selected diet.
            Eating an element outside the diet does not increase the score but still adds to the total elements eaten.
        </p>
        <p>
            The score display shows:
            <br><b>Score / Total Elements Eaten (Percentage)</b>
        </p>
    </div>
</div>

    <!-- Canvas del gioco -->
    <div id="selectedDietText" style="display: none;"></div>
    <div id="scoreBoard" style="display: none;"></div>
    <div id="touchArea"></div>
    <canvas id="gameCanvas"></canvas>


    <!-- Game Over -->
    <div id="gameover" style="display: none;"></div>

    <!-- Citazione -->
    <div id="citation">
        <a href="https://zenodo.org/records/10643098" target="_blank">
            Pietro Galizia <i>"Snakeleev: Gamifying the Periodic Table Through the Snake Game"</i> 
            <br>J. Chem. Educ. <b>2025</b>, Vol., n., DOI: 10.1021/acs.jchemed.
        </a>
    </div>
        
<script>
    // Mappa dei livelli di velocità
    const SPEED_LEVELS = {
        1: { speed: 1, delay: 333.335682979179 },
        2: { speed: 2, delay: 222.22180439293 },
        3: { speed: 3, delay: 166.666353296221 },
        4: { speed: 4, delay: 111.11027381 },
        5: { speed: 5, delay: 83.3333325282574 }
    };

    let maxElementsToUse = 40;
    let isElementCountChanged = false;
    let isSpeedChanged = false;  
    let rangeValue = 40;

    // Funzione per aggiornare l'etichetta della velocità
    function updateSpeedLabel() {
        const speedValue = document.getElementById('speedRange').value;
        const selectedSpeed = SPEED_LEVELS[speedValue].speed; // Ottiene la velocità in px/sec

        document.getElementById('selectedSpeed').textContent = `Speed: ${selectedSpeed}`;
        window.SPEED = SPEED_LEVELS[speedValue].delay; // Imposta il ritardo in ms
        isSpeedChanged = true;
    }

    // Funzione per aggiornare il numero massimo di elementi
    function updateElementCount() {
        maxElementsToUse = parseInt(document.getElementById('elementRange').value);
    
        document.getElementById('selectedElementCount').textContent = `Element Range: 1 ≤ Z ≤ ${maxElementsToUse}`;
    
        isElementCountChanged = true; // Segnala che lo slider è stato modificato
    }




    // Mostra la schermata iniziale al caricamento della pagina
    document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('speedRange').addEventListener('input', updateSpeedLabel);
        document.getElementById('elementRange').addEventListener('input', updateElementCount);
        document.getElementById('selectedElementCount').textContent = `Element Range: 1 ≤ Z ≤ 40`;
        // Imposta la velocità predefinita all'avvio
        const speedSlider = document.getElementById('speedRange');
        window.SPEED = SPEED_LEVELS[speedSlider.value];

        // Aggiorna dinamicamente la velocità mentre si sposta lo slider
        speedSlider.addEventListener('input', updateSpeedLabel);

        // Popola il dropdown delle diete
        const dietDropdown = document.getElementById("dietDropdown");
        const diets = [
            "Critical elements", "Elements of a smartphone", "Elements of life", "Elements of DNA",
            "Radioactive elements (U-Th decay series)", "Elements essential for man", "Elements used in therapy",
            "Elements used in diagnosis", "Medical radioisotopes",
            "Elements considered safety (grades A-E) in the first wall of fusion power plan",
            "Potentially toxic trace elements (PTEs)", "Toxic trace elements in dried mushrooms",
            "Elements dedicated to scientists", "Elements with names of Latin derivation",
            "Elements with names of Greek derivation",
            "Elements named after geographical locations and celestial bodies",
            "Elements with names not derived from Latin or Greek, nor from cities or countries",
            "Elements known since antiquity", "Elementary substances in solid state at STP",
            "Elementary substances in liquid state at STP", "Elementary substances in gas state at STP",
            "Ferromagnetic elements", "Ultra-high temperature metals", "Metals", "Nonmetals",
            "Elements of group I (Hydrogen & alkali metals)", "Elements of group II (Alkaline earth metals)",
            "Elements of group XV (Pnictogens)", "Elements of group XVI (Chalcogens)", "Elements of group XVII (Halogens)",
            "Elements of group XVIII (Noble gases)", "Lanthanides", "Actinides",
            "Transition metals", "Post-transition metals", "Metalloids", "Reactive nonmetals",
            "s-block elements", "p-block elements", "d-block elements", "f-block elements"
        ];

        // Aggiunge le opzioni al dropdown
        diets.forEach(diet => {
            const option = document.createElement("option");
            option.value = diet;
            option.textContent = diet;
            dietDropdown.appendChild(option);
        });

        // Mostra la schermata iniziale
        document.getElementById('title').style.display = 'block';
        document.getElementById('gameover').style.display = 'none';
        document.getElementById('startScreen').style.display = 'block';
    });

        function toggleInstructions() {
        var instructions = document.getElementById('instructions');
        var button = document.querySelector('[onclick="toggleInstructions()"]');
    
        if (instructions.style.display === "none") {
            instructions.style.display = "block";
            button.textContent = "Hide Instructions";
        } else {
            instructions.style.display = "none";
            button.textContent = "Show Instructions";
        }
    }

    // Funzione per avviare il gioco
    function finalSelection() {

        // Se l'utente non ha modificato lo slider, imposta il valore predefinito
           if (!isElementCountChanged) {
                updateElementCount();
            }

        if (!isSpeedChanged) {
            document.getElementById('speedRange').value = 3;
            updateSpeedLabel(); // Aggiorna l'interfaccia
        }
        
        selectedDiet = document.getElementById("dietDropdown").value;
        window.selectedDiet = selectedDiet;
        window.maxElementsToUse = maxElementsToUse;

        document.getElementById('title').style.display = 'none';
        document.getElementById('startScreen').style.display = 'none';
        document.getElementById('gameCanvas').style.display = 'block';
        document.getElementById('selectedDietText').style.display = 'block';
        document.getElementById('scoreBoard').style.display = 'block';
        document.getElementById('touchArea').style.zIndex = 10;
        
        startNewGame();
    }

    function startNewGame() {
        document.getElementById('title').style.display = 'none';
        document.getElementById('gameCanvas').style.display = 'block';
        startGame(); // Funzione definita in Snakeleev.js
    }

    function resetGameState() {
        location.reload(); // Ricarica la pagina
    }
</script>

    <script src="Snakeleev.js"></script>
</body>
</html>
